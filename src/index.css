@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 222.2 84% 4.9%;
    --card: 0 0% 100%;
    --card-foreground: 222.2 84% 4.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 222.2 84% 4.9%;
    --primary: 221.2 83.2% 53.3%;
    --primary-foreground: 210 40% 98%;
    --secondary: 210 40% 96%;
    --secondary-foreground: 222.2 84% 4.9%;
    --muted: 210 40% 96%;
    --muted-foreground: 215.4 16.3% 46.9%;
    --accent: 210 40% 96%;
    --accent-foreground: 222.2 84% 4.9%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;
    --border: 214.3 31.8% 91.4%;
    --input: 214.3 31.8% 91.4%;
    --ring: 221.2 83.2% 53.3%;
    --radius: 0.5rem;
  }

  .dark {
    --background: 222.2 84% 4.9%;
    --foreground: 210 40% 98%;
    --card: 222.2 84% 4.9%;
    --card-foreground: 210 40% 98%;
    --popover: 222.2 84% 4.9%;
    --popover-foreground: 210 40% 98%;
    --primary: 217.2 91.2% 59.8%;
    --primary-foreground: 222.2 84% 4.9%;
    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;
    --muted: 217.2 32.6% 17.5%;
    --muted-foreground: 215 20.2% 65.1%;
    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 40% 98%;
    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;
    --ring: 224.3 76.3% 94.1%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
}

/* TAVI design tokens and utilities (moved from inline) */
:root {
  --tavi-brand: 217 85% 34%;
  --tavi-text: 0 0% 10%;
  --tavi-surface: 0 0% 100%;
  --tavi-success: 142 72% 37%; /* approx #16A34A */
  --tavi-warning: 35 88% 38%; /* approx #B45309 */
  --tavi-border: 214.3 31.8% 91.4%;
}

.tavi-surface, .TAVI-surface { background: hsl(var(--tavi-surface)); color: hsl(var(--tavi-text)); }
.tavi-brand, .TAVI-brand { color: hsl(var(--tavi-brand)); }
.tavi-button-primary, .TAVI-button-primary { background: hsl(var(--tavi-brand)); color: white; }
.tavi-button-primary:focus-visible, .TAVI-button-primary:focus-visible { outline: 2px solid #104E8B; outline-offset: 2px; }
.tavi-chip, .TAVI-chip { border: 1px solid hsl(var(--tavi-border)); border-radius: 999px; padding: 6px 10px; }
.tavi-chat-bubble-tavi, .TAVI-chat-bubble-TAVI { background: #F3F7FF; border: 1px solid #DFE9FF; }
.tavi-chat-bubble-user, .TAVI-chat-bubble-user { background: #F9FAFB; border: 1px solid #E5E7EB; }
.tavi-success, .TAVI-success { color: hsl(var(--tavi-success)); }
.tavi-warning, .TAVI-warning { color: hsl(var(--tavi-warning)); }
.tavi-mono, .TAVI-mono { font-variant-numeric: tabular-nums; font-feature-settings: "tnum" 1; }
.tavi-text-strong, .TAVI-text-strong { color: #101010; }

/* Animations */
@keyframes spinSlow { from { transform: rotate(0deg);} to { transform: rotate(360deg);} }
.tavi-spin, .TAVI-spin { animation: spinSlow 1.2s linear infinite; }
@keyframes pulseRing { 0%{ box-shadow: 0 0 0 0 rgba(13,71,161,.3);} 70%{ box-shadow: 0 0 0 12px rgba(13,71,161,0);} 100%{ box-shadow: 0 0 0 0 rgba(13,71,161,0);} }
.pulse { animation: pulseRing 1.2s ease-out infinite; }

/* Accessibility */
.quick-reply:focus-visible { outline: 2px solid hsl(var(--tavi-brand)); outline-offset: 2px; }

/* Confirmation screen */
.tavi-confirm-header, .TAVI-confirm-header { display:flex; align-items:center; gap:12px; }
.tavi-confirm-amount, .TAVI-confirm-amount { font-size: 28px; font-weight: 800; }
.tavi-kv, .TAVI-kv { display:grid; grid-template-columns: 160px 1fr; row-gap: 6px; column-gap: 12px; }

/* Success overlay (pantalla verde) */
@keyframes overlayIn { from { opacity: 0; transform: scale(.98);} to { opacity: 1; transform: scale(1);} }
.success-overlay { position: fixed; inset: 0; background: rgba(22,163,74,.96); color: #fff; display:flex; align-items:center; justify-content:center; z-index: 50; animation: overlayIn .2s ease-out; }
.success-wrap { text-align:center; padding: 24px; }
.success-title { font-size: 28px; font-weight: 800; }
.success-sub { opacity: .95; margin-top: 6px; }

/* Demo layout */
body {
  margin: 0;
}

.demo-wrapper {
  max-width: 1200px;
  margin: 0 auto;
  padding: 24px 16px;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  box-sizing: border-box;
}

.app-shell {
  display: grid;
  grid-template-columns: 340px 1fr;
  gap: 24px;
  flex: 1;
  min-height: 0;
}

.chat-shell {
  display: flex;
  flex-direction: column;
  height: min(72vh, 640px);
  min-height: 0;
}

.chat-scroll-container {
  display: flex;
  flex-direction: column;
  flex: 1;
  min-height: 0;
}

.chat-scroll {
  flex: 1;
  padding: 12px;
  display: flex;
  flex-direction: column;
  min-height: 0;
}

.chat-input-container {
  margin-top: 12px;
}

.chat-input {
  display: flex;
  gap: 8px;
  width: 100%;
  align-items: center;
}

.chat-input .flex-1 {
  flex: 1;
  min-width: 0;
}

.chat-sticky-head {
  position: sticky;
  top: 0;
  z-index: 5;
  background: hsl(var(--savi-surface));
  padding: 0 0 8px;
  margin: 0 0 8px;
  border-bottom: 1px solid hsl(var(--savi-border));
  border-radius: 16px 16px 0 0;
}

@media (max-width: 980px) { .app-shell { grid-template-columns: 1fr; } }

/* Bottom navigation – improved (tokens, accesibilidad, microinteracciones) */
:root {
  --bn-height: 64px;
  --bn-fab-size: 56px;
  --bn-item-touch: 48px;
  --bn-active-bg: hsl(var(--primary) / 0.10);
  --bn-active-fg: hsl(var(--primary));
  --bn-inactive-fg: hsl(var(--muted-foreground));
  --bn-shadow: 0 -1px 2px rgba(0,0,0,.06);
}
.dark {
  --bn-active-bg: hsl(var(--primary) / 0.18);
  --bn-inactive-fg: hsl(var(--muted-foreground) / 0.9);
}

.bn { position: sticky; bottom: 0; left: 0; right: 0; display: grid; grid-template-columns: 1fr 1fr auto 1fr 1fr; gap: 8px; align-items: center; padding: 8px 12px calc(8px + env(safe-area-inset-bottom)); background: hsl(var(--background)); border-radius: 16px; border: 1px solid hsl(var(--border)); box-shadow: var(--bn-shadow); margin-top: 16px; min-height: var(--bn-height); transition: transform .16s ease-in-out; will-change: transform; z-index: 50; }
.bn-hidden { transform: translateY(100%); }

.bn-item { display:flex; flex-direction:column; align-items:center; justify-content:center; gap:4px; padding:8px 6px; color: var(--bn-inactive-fg); font-size:12px; border-radius:12px; min-width: var(--bn-item-touch); min-height: var(--bn-item-touch); transition: color .18s ease, background-color .18s ease, transform .15s ease; }
.bn-item:focus-visible { outline: none; box-shadow: 0 0 0 2px hsl(var(--ring)); }
.bn-item[data-active="true"], .bn-item-active { color: var(--bn-active-fg); background: var(--bn-active-bg); transform: scale(1.05); }

.bn-icon { width: 20px; height: 20px; }

.bn-fab { display:flex; align-items:center; justify-content:center; width: var(--bn-fab-size); height: var(--bn-fab-size); border-radius:999px; background: hsl(var(--primary) / 0.08); color: hsl(var(--primary)); border: 1px solid hsl(var(--border)); margin:0 6px; box-shadow: 0 8px 24px rgba(0,0,0,.06); transition: transform .15s ease, background-color .18s ease, color .18s ease; transform: translateY(-8px); }
.bn-fab:focus-visible { outline: none; box-shadow: 0 0 0 2px hsl(var(--ring)); }
.bn-fab-active { outline: 2px solid #94a3b8; outline-offset: 2px; }

/* Solo el logo central de TAVI dentro del FAB: que llene el círculo */
.bn-fab .tavi-fab-logo { width: calc(var(--bn-fab-size) * 0.55); height: calc(var(--bn-fab-size) * 0.55); }

@media (prefers-reduced-motion: reduce) {
  .bn, .bn-item, .bn-fab { transition: none !important; transform: none !important; }
}

/* QuickReplies microinteractions */
.quick-reply { transition: transform .12s ease-out, opacity .12s ease-out; }
.quick-reply:active { transform: scale(0.97); opacity: .9; }

/* Map Tailwind variables to SAVI tokens */
@layer base {
  :root {
    --primary: var(--savi-brand);
    --ring: var(--savi-brand);
  }
}

/* Brand chips for CoDI® and Dimo® */
.brand-chip { display:inline-flex; align-items:center; gap:6px; padding:2px 8px; border-radius:999px; font-size:11px; line-height:1; border:1px solid hsl(var(--savi-border)); }
.brand-codi { background:#F5FFFB; color:#0A7F5A; border-color:#BFEFE0; }
.brand-dimo { background:#F5F7FF; color:#0D47A1; border-color:#D6E2FF; }

/* Micro‑hint ephemeral labels */
@keyframes microHintFade { 0% { opacity: 0; transform: translateY(4px);} 10% { opacity: 1; transform: translateY(0);} 80% { opacity: 1;} 100% { opacity: 0; transform: translateY(-2px);} }
.micro-hint { animation: microHintFade 1.9s ease forwards; border-radius: 12px; padding: 4px 8px; box-shadow: 0 1px 2px rgba(0,0,0,.06); }
.micro-hint-neutral { background: #F8FAFC; color: #0F172A; }
.micro-hint-success { background: #ECFDF5; color: #065F46; }

/* Home (Inicio) helpers — light blue accents */
.home-card { background: #EFF6FF; color: #0F172A; border: 1px solid #DBEAFE; border-radius: 14px; padding: 12px; box-shadow: 0 1px 2px rgba(0,0,0,.04); }
.home-chip { display:inline-flex; align-items:center; gap:6px; background:#DBEAFE; color:#1E3A8A; border-radius:999px; padding:2px 8px; font-size:11px; line-height:1; }
.home-banner { background:#DCFCE7; color:#065F46; border:1px solid #BBF7D0; border-radius:14px; padding:12px; margin-top:12px; }
.action-grid { display:grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap:12px; margin-top:16px; }
.action-pill { display:flex; flex-direction:column; align-items:center; justify-content:center; gap:8px; background:#EFF6FF; color:#0F172A; border:1px solid #DBEAFE; border-radius:14px; padding:12px; height:96px; transition: background .15s ease; }
.action-pill:hover { background:#DBEAFE; }
.action-pill:focus-visible { outline: 2px solid #93C5FD; outline-offset: 2px; }
.cards-row { display:flex; gap:12px; overflow-x:auto; padding-bottom:8px; scroll-snap-type:x mandatory; }
.card-item { min-width:260px; background:#fff; border:1px solid #e5e7eb; border-radius:14px; padding:16px; box-shadow: 0 1px 2px rgba(0,0,0,.04); scroll-snap-align:start; }
.pending-tile { display:flex; align-items:center; justify-content:space-between; gap:12px; background:#FFFBEB; color:#78350F; border:1px solid #FDE68A; border-radius:14px; padding:16px; margin-top:16px; }
.modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,.4); z-index: 40; }
.modal-window { position: fixed; z-index: 50; left: 50%; top: 50%; transform: translate(-50%, -50%); background: #fff; border-radius: 14px; box-shadow: 0 12px 40px rgba(0,0,0,.18); width: min(92vw, 420px); padding: 16px; }
/* Bottom sheet modifier for CLABE */
.sheet-window { left: 50%; bottom: 0; top: auto; transform: translate(-50%, 0); border-bottom-left-radius: 0; border-bottom-right-radius: 0; width: min(96vw, 520px); }
